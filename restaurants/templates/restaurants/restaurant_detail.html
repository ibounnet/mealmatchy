{% extends 'base.html' %}
{% block title %}{{ restaurant.name }} | ร้านอาหาร{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto">

  {# การ์ดข้อมูลร้าน #}
  <div class="bg-white rounded-2xl shadow-card border border-gray-200 p-5 mb-6 flex gap-4 items-center">
    {% if restaurant.image %}
      <img src="{{ restaurant.image.url }}"
           alt="{{ restaurant.name }}"
           class="w-28 h-28 rounded-2xl object-cover flex-shrink-0">
    {% endif %}
    <div class="flex-1">
      <h1 class="text-xl font-bold mb-1">{{ restaurant.name }}</h1>
      <p class="text-xs text-gray-500 mb-1">
        ที่ตั้ง: {{ restaurant.location|default:"-" }}
      </p>
      <p class="text-sm text-gray-600">
        {{ restaurant.description|default:"ยังไม่มีรายละเอียดร้าน" }}
      </p>
    </div>

    {% if request.user.is_authenticated %}
      <a href="{% url 'menus:add_menu_to_restaurant' restaurant.id %}"
         class="px-4 py-2 rounded-xl bg-primary text-white hover:bg-primary-dark text-sm">
        + เพิ่มเมนูในร้านนี้
      </a>
    {% endif %}
  </div>

  {# รายการเมนูของร้านนี้ #}
  <h2 class="text-xl font-semibold mb-3">เมนูของร้านนี้</h2>

  {% if menus %}
    <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
      {% for m in menus %}
        <div class="bg-white rounded-2xl shadow-card border border-gray-200 overflow-hidden flex flex-col">

          {# รูปเมนู #}
          {% if m.image %}
            <img src="{{ m.image.url }}"
                 alt="{{ m.name }}"
                 class="w-full h-52 object-cover">
          {% else %}
            <div class="w-full h-52 bg-gray-100 flex items-center justify-center text-gray-400">
              ไม่มีรูปภาพ
            </div>
          {% endif %}

          {# เนื้อหาการ์ด #}
          <div class="p-4 flex-1 flex flex-col justify-between">
            <div class="space-y-1">
              <div class="text-base font-semibold text-gray-900">
                {{ m.name }}
              </div>

              <p class="text-xs text-gray-500">
                สร้างโดย: {{ m.created_by.username|default:"ไม่ทราบ" }}
                • {{ m.created_at|date:"d/m/Y" }}
              </p>

              {# แสดงสถานะเมนู #}
              {% if m.status == 'PENDING' %}
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-50 text-yellow-700">
                  รออนุมัติจากแอดมิน
                </span>
              {% elif m.status == 'REJECTED' %}
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-50 text-red-700">
                  ถูกปฏิเสธ
                </span>
              {% elif m.status == 'APPROVED' and request.user.is_staff %}
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-50 text-green-700">
                  อนุมัติแล้ว
                </span>
              {% endif %}
            </div>

            <div class="mt-3 text-sm font-semibold text-orange-600">
              {{ m.price }} บาท
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p class="text-gray-500 text-sm mt-4">
      ยังไม่มีเมนูในร้านนี้ (เฉพาะเมนูที่ถูกอนุมัติจึงจะแสดงแก่ผู้ใช้คนอื่น)
    </p>
  {% endif %}

  <div class="mt-6">
    <a href="{% url 'restaurants:restaurant_list' %}"
       class="text-sm text-gray-600 hover:underline">
      ← กลับหน้าร้านอาหารทั้งหมด
    </a>
  </div>

</div>
{% endblock %}
